# üîê 1Password Setup - COSMIC RAG

**IMPORTANT** : Workflow interne FFT - Tous les acc√®s dans 1Password

---

## üìã Entr√©es √† Cr√©er

### 1. Vercel Production Password

**Quand** : Apr√®s `vercel --prod` (J1 ou J2)

**Commande** :
```bash
# Generate strong password
export VERCEL_PASSWORD=$(openssl rand -base64 32)

# Store in 1Password
op item create \
  --category=password \
  --title="COSMIC RAG - Vercel Production" \
  --vault="FFT-Projects" \
  --url="https://cosmic-rag.vercel.app" \
  password="$VERCEL_PASSWORD" \
  username="evaluator" \
  --tags="cosmic,vercel,production"

# Add to Vercel
vercel env add VERCEL_PASSWORD production
# Paste: $VERCEL_PASSWORD

echo "‚úÖ Password stored in 1Password and Vercel"
```

**Ou via 1Password GUI** :
1. Ouvrir 1Password ‚Üí Vault "FFT-Projects"
2. Nouveau item ‚Üí Password
3. **Titre** : `COSMIC RAG - Vercel Production`
4. **Username** : `evaluator` (ou `cosmic-reviewer`)
5. **Password** : [Generate strong password - 32 chars]
6. **URL** : `https://cosmic-rag.vercel.app`
7. **Tags** : `cosmic`, `vercel`, `production`
8. **Section Notes** :
   ```
   Purpose: Production site access for COSMIC evaluators
   Created: 2025-10-22
   Expires: Post-COSMIC (2025-11-01 if not renewed)
   Shared with: FFT team only
   Access level: View-only (no admin)
   ```

---

### 2. GitHub Repository Access

**Entr√©e 1Password** :

```bash
op item create \
  --category=login \
  --title="GitHub - nextAIgeneration/cosmic-rag" \
  --vault="FFT-Projects" \
  --url="https://github.com/nextAIgeneration/cosmic-rag" \
  username="[GitHub account owner]" \
  --tags="cosmic,github,nextaigeneration"
```

**Ou via GUI** :
- **Titre** : `GitHub - nextAIgeneration/cosmic-rag`
- **URL** : `https://github.com/nextAIgeneration/cosmic-rag`
- **Type** : Login
- **Notes** :
  ```
  Repository: nextAIgeneration/cosmic-rag
  Visibility: Public
  Owner: nextAIgeneration organization
  Collaborators: [List team members]
  Branch protection: main (review required)
  ```

---

### 3. GitLab Mercure - cosmic-rag-validation

**Entr√©e 1Password** :

```bash
op item create \
  --category=login \
  --title="GitLab Mercure - cosmic-rag-validation" \
  --vault="FFT-Projects" \
  --url="https://gitlab.com/enzoxic03/cosmic-rag-validation" \
  username="enzoxic03" \
  --tags="cosmic,gitlab,mercure,private"
```

**Notes importantes** :
```
Repository: enzoxic03/cosmic-rag-validation
Visibility: PRIVATE
Purpose: Pre-release validation (packages A & C)
Branches:
  - package-c: EU-pure projects (zero risk) ‚Üí PUBLISHED
  - package-a: Full analytics (standby post-COSMIC)
Access: enzoxic03 only (expand to team if needed)
```

---

### 4. Vercel Project Access

**Entr√©e 1Password** :

```bash
op item create \
  --category=login \
  --title="Vercel - cosmic-rag Project" \
  --vault="FFT-Projects" \
  --url="https://vercel.com/[account]/cosmic-rag" \
  username="[Vercel account email]" \
  --tags="cosmic,vercel,dashboard"
```

**Fields √† ajouter** :
- **Project ID** : [Auto-generated by Vercel]
- **Team** : nextAIgeneration (or personal)
- **Deploy URL** : `https://cosmic-rag.vercel.app`
- **API Token** : [If needed for CI/CD]

---

## üîë Secrets √† Stocker

### Variables d'Environnement Vercel

**Si besoin d'analytics ou APIs externes** :

```bash
# Example: Google Analytics (optionnel)
op item create \
  --category=api-credential \
  --title="COSMIC RAG - Google Analytics" \
  --vault="FFT-Projects" \
  credential="GA-XXXXXXXXX" \
  --tags="cosmic,analytics"

# Store in Vercel
vercel env add NEXT_PUBLIC_GA_ID production
# Value from: op read "op://FFT-Projects/COSMIC RAG - Google Analytics/credential"
```

**Actuellement** : Aucune API externe n√©cessaire (data statique)

---

## üë• Partage √âquipe (Workflow Interne)

### Qui a Acc√®s ?

**Vault FFT-Projects** :
- ‚úÖ Toi (owner)
- ‚úÖ [Membres √©quipe FFT √† ajouter]
- ‚úÖ [Evaluateurs COSMIC si n√©cessaire - temporaire]

**Permissions** :
- **Admins** : Toi + [Lead FFT]
- **Editors** : [D√©veloppeurs FFT]
- **Viewers** : [Evaluateurs COSMIC - temporaire]

### Partager Vercel Password avec Evaluateurs

**Workflow s√©curis√©** :

1. **Cr√©er lien de partage temporaire** :
   ```bash
   op item share "COSMIC RAG - Vercel Production" \
     --emails "evaluator1@cosmic.eu,evaluator2@cosmic.eu" \
     --expiry 7d \
     --view-once
   ```

2. **Ou email s√©curis√©** (si 1Password share pas dispo) :
   ```
   Subject: COSMIC RAG - Site Access

   Dear Evaluator,

   Access to COSMIC RAG demo site:
   URL: https://cosmic-rag.vercel.app
   Password: [From 1Password - send via secure channel]

   Note: This password is temporary and will be reset after evaluation.

   Best regards,
   FFT Cognitive Platform Team
   ```

---

## üîÑ Workflow 1Password Standard

### Cr√©ation d'un Nouveau Projet

**Template** :
```bash
#!/bin/bash
# create-project-1password.sh

PROJECT_NAME="$1"
VAULT="FFT-Projects"

# 1. GitHub repo
op item create \
  --category=login \
  --title="GitHub - nextAIgeneration/$PROJECT_NAME" \
  --vault="$VAULT" \
  --url="https://github.com/nextAIgeneration/$PROJECT_NAME"

# 2. Vercel project
op item create \
  --category=login \
  --title="Vercel - $PROJECT_NAME" \
  --vault="$VAULT" \
  --url="https://vercel.com/[account]/$PROJECT_NAME"

# 3. Vercel production password
VERCEL_PWD=$(openssl rand -base64 32)
op item create \
  --category=password \
  --title="$PROJECT_NAME - Vercel Production" \
  --vault="$VAULT" \
  password="$VERCEL_PWD"

echo "‚úÖ 1Password entries created for $PROJECT_NAME"
echo "Vercel password: stored in vault $VAULT"
```

**Usage** :
```bash
chmod +x create-project-1password.sh
./create-project-1password.sh cosmic-rag
```

---

## üìä Audit Trail (1Password Activity)

### V√©rifier Acc√®s

```bash
# List all items in vault
op item list --vault="FFT-Projects" --tags="cosmic"

# Get specific item
op item get "COSMIC RAG - Vercel Production" --vault="FFT-Projects"

# Check who accessed
op item get "COSMIC RAG - Vercel Production" --vault="FFT-Projects" --fields label=history
```

### Rotation Password Post-COSMIC

```bash
# Generate new password
NEW_PWD=$(openssl rand -base64 32)

# Update 1Password
op item edit "COSMIC RAG - Vercel Production" \
  --vault="FFT-Projects" \
  password="$NEW_PWD"

# Update Vercel
vercel env rm VERCEL_PASSWORD production
vercel env add VERCEL_PASSWORD production
# Paste: $NEW_PWD

echo "‚úÖ Password rotated"
```

---

## üö® S√©curit√© Post-COSMIC

### Apr√®s √âvaluation (28 Oct+)

**Si site reste public** :
- [ ] D√©sactiver password protection Vercel
- [ ] Supprimer entr√©e 1Password "Vercel Production"
- [ ] Documenter dans changelog

**Si site reste priv√©** :
- [ ] Rotate password (supprimer acc√®s evaluateurs)
- [ ] Mettre √† jour 1Password avec nouveau password
- [ ] Configurer auto-expiry (ex: 90 jours)

**Si site archiv√©** :
- [ ] Archive Vercel project (ou delete)
- [ ] Archive entries 1Password (ne pas delete - historique)
- [ ] Update README: "Archived post-COSMIC"

---

## üìã Checklist 1Password COSMIC RAG

### Avant Vercel Deploy

- [ ] Vault "FFT-Projects" existe
- [ ] Acc√®s 1Password CLI configur√© (`op --version`)
- [ ] Team members ajout√©s au vault (si applicable)

### Pendant Vercel Deploy

- [ ] Generate strong password (32+ chars)
- [ ] Store in 1Password **AVANT** de l'ajouter √† Vercel
- [ ] Tag correctement (`cosmic`, `vercel`, `production`)
- [ ] Add notes (purpose, expiry, access level)

### Apr√®s Deploy

- [ ] Verify password dans 1Password accessible
- [ ] Test login Vercel site avec password
- [ ] Share avec evaluateurs (si applicable)
- [ ] Document dans README o√π trouver credentials

### Post-COSMIC

- [ ] Rotate password (remove evaluators access)
- [ ] Update 1Password entry
- [ ] Set expiry reminder (90 days)
- [ ] Archive ou delete selon d√©cision

---

## üîó Int√©gration CI/CD (Futur)

### GitHub Actions ‚Üí 1Password

**Si tu veux auto-deploy depuis GitHub** :

```yaml
# .github/workflows/deploy.yml
name: Deploy to Vercel

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Load secrets from 1Password
        uses: 1password/load-secrets-action@v1
        with:
          export-env: true
        env:
          OP_SERVICE_ACCOUNT_TOKEN: ${{ secrets.OP_SERVICE_ACCOUNT_TOKEN }}
          VERCEL_TOKEN: op://FFT-Projects/Vercel API Token/credential

      - name: Deploy to Vercel
        run: |
          npm install -g vercel
          vercel --token=$VERCEL_TOKEN --prod
```

**Setup** :
1. Create 1Password service account
2. Add to GitHub secrets: `OP_SERVICE_ACCOUNT_TOKEN`
3. Store Vercel token in 1Password
4. Configure workflow

---

## üìû Support

**Si probl√®me 1Password** :
- Doc officielle : https://developer.1password.com/docs/cli
- FFT internal wiki : [Link to internal docs]
- Contact : [IT support email]

**Si credentials perdus** :
- Recovery : Via 1Password emergency kit
- Backup : Vault exports (encrypted)
- Escalation : [Admin 1Password account]

---

## ‚úÖ Quick Start (TL;DR)

```bash
# 1. Generate password
VERCEL_PWD=$(openssl rand -base64 32)

# 2. Store in 1Password
op item create \
  --category=password \
  --title="COSMIC RAG - Vercel Production" \
  --vault="FFT-Projects" \
  --url="https://cosmic-rag.vercel.app" \
  password="$VERCEL_PWD" \
  --tags="cosmic,vercel"

# 3. Add to Vercel
vercel env add VERCEL_PASSWORD production
# Paste: $VERCEL_PWD

# 4. Test
curl -u "evaluator:$VERCEL_PWD" https://cosmic-rag.vercel.app

# DONE ‚úÖ
```

---

**Cr√©√©** : 2025-10-22
**Pour** : COSMIC RAG Vercel Deploy
**Vault** : FFT-Projects
**Status** : Ready for deployment
